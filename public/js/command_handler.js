// Generated by CoffeeScript 1.5.0
(function() {
  var CommandHandler, t;

  t = THREE;

  CommandHandler = (function() {
    var ProtoBuf;

    ProtoBuf = dcodeIO.ProtoBuf;

    function CommandHandler(root, protocol) {
      this.root = root;
      this.protocol = protocol;
      this.protocol = ProtoBuf.loadProtoFile("/protocol.proto");
      this.CommandType = this.protocol.build("CommandType");
    }

    CommandHandler.prototype.executeCommand = function(command, localExecution) {
      var board, board_id, height, pitch, width, x, y, yaw, z, _ref;
      switch (command.type) {
        case this.CommandType.BOARD_CREATE:
          _ref = command.board_create, width = _ref.width, height = _ref.height, x = _ref.x, y = _ref.y, z = _ref.z, pitch = _ref.pitch, yaw = _ref.yaw;
          board_id = command.board_id;
          board = new Board(board_id, width, height, new t.Vector3(x, y, z), yaw, pitch);
          board.addToScene(this.root.scene);
          board.drawOn(function(ctx, width, height) {
            ctx.fillStyle = "#FFFFFF";
            return ctx.fillRect(0, 0, width, height);
          });
          return this.root.addBoard(board);
        case this.CommandType.DRAW:
          board = this.root.getBoard(command.board_id);
          if (board) {
            board.drawOn(function(ctx, width, height) {
              ctx.fillStyle = "#FF0000";
              return ctx.fillRect(Math.floor(command.draw.x * width), Math.floor(command.draw.y * height), 10, 10);
            });
            if (localExecution) {
              return board.refresh();
            }
          }
      }
    };

    return CommandHandler;

  })();

  window.CommandHandler = CommandHandler;

}).call(this);
